(this.webpackJsonpkotipelit=this.webpackJsonpkotipelit||[]).push([[0],{14:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return n}));var n=function(t){e&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}),0}}).call(this,a(70))},172:function(e,t,a){e.exports=a(234)},230:function(e,t){},234:function(e,t,a){"use strict";a.r(t);var n,r,c,o,i,l,u=a(0),s=a.n(u),E=a(15),m=a.n(E),d=a(9),p=a(50),f=a(140),S=a(11),v=a.n(S),O=a(23),g=a(6);!function(e){e.SANAKIERTO="sanakierto"}(n||(n={})),function(e){e.RUNNING="Running",e.WAITING="Waiting for players",e.UPCOMING="Upcoming",e.FINISHED="Finished"}(r||(r={})),function(e){e.SET_ACTIVE_GAME="SET_ACTIVE_GAME",e.INIT_GAMES_REQUEST="INIT_GAMES_REQUEST",e.INIT_GAMES_SUCCESS="INIT_GAMES_SUCCESS",e.INIT_GAMES_FAILURE="INIT_GAMES_FAILURE",e.ADD_GAME_REQUEST="ADD_GAME_REQUEST",e.ADD_GAME_SUCCESS="ADD_GAME_SUCCESS",e.ADD_GAME_FAILURE="ADD_GAME_FAILURE",e.DELETE_GAME_REQUEST="DELETE_GAME_REQUEST",e.DELETE_GAME_SUCCESS="DELETE_GAME_SUCCESS",e.DELETE_GAME_FAILURE="DELETE_GAME_FAILURE",e.LAUNCH_GAME="LAUNCH_GAME",e.UPDATE_ACTIVE_GAME="UPDATE_ACTIVE_GAME",e.LOGIN_REQUEST="LOGIN_REQUEST",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_FAILURE="LOGIN_FAILURE",e.LOGOUT="LOGOUT",e.SET_JITSI_TOKEN="SET_JITSI_TOKEN",e.SET_JITSI_ROOM="SET_JITSI_ROOM",e.SET_SOCKET="SET_SOCKET",e.SET_DISPLAYNAME="SET_DISPLAYNAME",e.INIT_CHANNELS_REQUEST="INIT_CHANNELS_REQUEST",e.INIT_CHANNELS_SUCCESS="INIT_CHANNELS_SUCCESS",e.INIT_CHANNELS_FAILURE="INIT_CHANNELS_FAILURE"}(c||(c={})),function(e){e.JOIN_GAME="join game",e.JOIN_SUCCESS="join success",e.JOIN_FAILURE="join failure",e.GAME_READY="game ready",e.GAME_STARTING="game starting",e.GAME_UPDATED="game updated"}(o||(o={})),function(e){e.JITSI_READY="jitsi ready",e.CREATE_ROOM="create room",e.START_GAME="start game",e.UPDATE_GAME="update game",e.CREATE_SUCCESS="create success",e.CREATE_FAILURE="create failure",e.START_SUCCESS="start success",e.START_FAILURE="start failure",e.UPDATE_SUCCESS="update success",e.UPDATE_FAILURE="update failure"}(i||(i={})),function(e){e.AUTH_REQUEST="authenticate",e.AUTHENTICATED="authenticated",e.UNAUTHORIZED="unauthorized",e.CONNECT="connect",e.PLAYER_JOINED="player joined"}(l||(l={}));var A=a(46),T=a.n(A),I=null,_={login:function(){var e=Object(O.a)(v.a.mark((function e(t,a){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={username:t,password:a},e.next=3,T.a.post("/api/login",n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),setToken:function(e){I=e},getAuthHeader:function(){if(!I)throw new Error("K\xe4ytt\xe4j\xe4n token puuttuu");return"Bearer ".concat(I)},getAll:function(){var e=Object(O.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getToken:function(){return I}},N={getAll:function(){var e=Object(O.a)(v.a.mark((function e(){var t,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:_.getAuthHeader()}},e.next=3,T.a.get("/api/games",t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),addNew:function(){var e=Object(O.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:_.getAuthHeader()}},e.next=3,T.a.post("/api/games",t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteGame:function(){var e=Object(O.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:_.getAuthHeader()}},e.next=3,T.a.delete("".concat("/api/games","/").concat(t),a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},b={allGames:[],activeGame:null,loading:!1},j=function(e){switch(e.type){case n.SANAKIERTO:return Object(g.a)(Object(g.a)({},e),{},{status:r.WAITING,info:{turn:"TODO",round:1}});default:throw new Error("Something went wrong, expected a selectable game, got ".concat(e.type))}},h=function(e){return{type:c.INIT_GAMES_SUCCESS,payload:e}},C=function(e){return{type:c.SET_ACTIVE_GAME,payload:e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.INIT_GAMES_REQUEST:return Object(g.a)(Object(g.a)({},e),{},{loading:!0});case c.INIT_GAMES_SUCCESS:return Object(g.a)(Object(g.a)({},e),{},{allGames:t.payload,loading:!1});case c.INIT_GAMES_FAILURE:return Object(g.a)(Object(g.a)({},e),{},{loading:!1});case c.ADD_GAME_REQUEST:return Object(g.a)(Object(g.a)({},e),{},{loading:!0});case c.ADD_GAME_SUCCESS:return Object(g.a)(Object(g.a)({},e),{},{allGames:e.allGames.concat(t.payload),loading:!1});case c.ADD_GAME_FAILURE:return Object(g.a)(Object(g.a)({},e),{},{loading:!1});case c.DELETE_GAME_REQUEST:return Object(g.a)(Object(g.a)({},e),{},{loading:!0});case c.DELETE_GAME_SUCCESS:return Object(g.a)(Object(g.a)({},e),{},{allGames:e.allGames.filter((function(e){return e.id!==t.payload})),loading:!1});case c.DELETE_GAME_FAILURE:return Object(g.a)(Object(g.a)({},e),{},{loading:!1});case c.SET_ACTIVE_GAME:return Object(g.a)(Object(g.a)({},e),{},{activeGame:t.payload});case"LAUNCH_GAME":var a=e.allGames.find((function(e){return e.id===t.payload}));if(!a)throw new Error("Game not found");var n=j(a);return Object(g.a)(Object(g.a)({},e),{},{activeGame:n,allGames:e.allGames.map((function(e){return e.id===t.payload?Object(g.a)(Object(g.a)({},e),{},{status:r.WAITING}):e}))});case"UPDATE_ACTIVE_GAME":return Object(g.a)(Object(g.a)({},e),{},{activeGame:t.payload});default:return e}},R={loggedIn:!1,socket:null,jitsiRoom:null,displayName:null},U=function(e){return{type:c.LOGIN_SUCCESS,payload:e}},L=function(e){return{type:c.SET_JITSI_ROOM,payload:e}},G=function(e){return{type:c.SET_SOCKET,payload:e}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.LOGIN_REQUEST:return Object(g.a)(Object(g.a)({},e),{},{loggingIn:!0});case c.LOGIN_SUCCESS:return Object(g.a)(Object(g.a)({},t.payload),{},{loggedIn:!0,jitsiToken:null,socket:null,jitsiRoom:null});case c.LOGIN_FAILURE:case c.LOGOUT:return{loggedIn:!1,socket:null,jitsiRoom:null,displayName:null};case c.SET_JITSI_TOKEN:return Object(g.a)(Object(g.a)({},e),{},{jitsiToken:t.payload});case c.SET_JITSI_ROOM:return Object(g.a)(Object(g.a)({},e),{},{jitsiRoom:t.payload});case c.SET_SOCKET:return Object(g.a)(Object(g.a)({},e),{},{socket:t.payload});case c.SET_DISPLAYNAME:return Object(g.a)(Object(g.a)({},e),{},{displayName:t.payload});default:return e}},k={allChannels:[],loading:!1},D=function(e){return{type:c.INIT_CHANNELS_SUCCESS,payload:e}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.INIT_CHANNELS_REQUEST:return Object(g.a)(Object(g.a)({},e),{},{loading:!0});case c.INIT_CHANNELS_SUCCESS:return{allChannels:t.payload,loading:!1};case c.INIT_CHANNELS_FAILURE:return Object(g.a)(Object(g.a)({},e),{},{loading:!1});default:return e}},x=Object(p.combineReducers)({games:y,user:w,channels:M}),P=a(141),B=Object(p.createStore)(x,Object(P.composeWithDevTools)(Object(p.applyMiddleware)(f.a))),F=a(19),H=a(29),K=a(292),J=a(289),Y=a(279),Q=a(281),W=a(293),V=a(276),z=a(298),Z=Object(V.a)((function(e){return Object(z.a)({container:{padding:e.spacing(2),textAlign:"center"},linkContainer:{marginTop:e.spacing(2)}})})),X=function(){var e=Z(),t=Object(d.d)((function(e){return e.channels.allChannels}),d.b);return s.a.createElement("div",{className:e.container},s.a.createElement("div",null,s.a.createElement(Q.a,{variant:"h3"},"Kanavat:")),t.map((function(t){return s.a.createElement("div",{key:t.username,className:e.linkContainer},s.a.createElement(Y.a,{component:H.b,to:"/".concat(t.username),variant:"outlined"},t.channelName))})))},q=function(e){var t=e.user,a=Object(d.c)(),n=Object(F.f)();return t&&t.loggedIn?u.createElement(Y.a,{color:"inherit",onClick:function(){a((window.localStorage.removeItem("kotipelitUser"),{type:c.LOGOUT})),n.push("/")}},u.createElement(Q.a,null,"Kirjaa ulos ".concat(t.username))):u.createElement(Y.a,{color:"inherit",onClick:function(){var e,t;a((e="username",t="password",function(){var a=Object(O.a)(v.a.mark((function a(n){var r,o;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:c.LOGIN_REQUEST}),a.prev=1,a.next=4,_.login(e,t);case 4:r=a.sent,_.setToken(r.token),o=Object(g.a)({},r),window.localStorage.setItem("kotipelitUser",JSON.stringify(o)),n(U(o)),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(1),n({type:c.LOGIN_FAILURE});case 14:case"end":return a.stop()}}),a,null,[[1,11]])})));return function(e){return a.apply(this,arguments)}}()))}},u.createElement(Q.a,null,"Kirjaudu"))},$=a(238),ee=a(291),te=a(24),ae=a(150),ne=a(151),re=a(32),ce=a(284),oe=a(285),ie=a(286),le=a(287),ue=a(288),se=a(240),Ee=a(283),me=a(237),de=a(300),pe=a(290),fe=a(297),Se=a(294),ve=a(147),Oe=a.n(ve),ge=a(108),Ae=["DIABOLATRY","FURIOUS","ARCH","DRUGSTORE","DONATION","HORROR","SICK","CARIBOU","BLIP","SNAIL","AIRPORT","MILKY","THINGS","PRAGMATIC","NASTY","CURVED","LIBERATING","BELT","GRIZZLY","BIGMOUTH","HOROSCOPE","LIME","HIGHWAY","THINGS","MACHINE","AGGRESSION","BARBWIRE","PROPELLER","BLEEP","DEDUCTION"],Te=function(){return Ae[Math.floor(Math.random()*Ae.length)]},Ie=function(){for(var e=[],t=[],a=1;a<=5;a++){for(var n=[];n.length<3;){var r=Te();t.includes(r)||(n.push(r),t.push(r))}e.push({id:Object(fe.a)(),name:"Pelaaja ".concat(a),words:n,points:0,online:!1})}return e},_e=function(e,t,a){var r=function(t,a){var n=e.values.players.map((function(e){if(e.name===t.name){var n=e.words;return n[a]=Te(),Object(g.a)(Object(g.a)({},e),{},{words:n})}return e}));e.setValues(Object(g.a)(Object(g.a)({},e.values),{},{players:n}))};return s.a.createElement(re.c,null,s.a.createElement("div",{className:t.gameInfo},s.a.createElement(Ee.a,{row:!0,className:t.formRow},s.a.createElement(Q.a,{className:t.marginRight,component:"label",variant:"h6",htmlFor:"startTime"},"Alkamisaika:"),s.a.createElement(re.a,{component:Se.a,autoOk:!0,ampm:!1,format:"d. MMMM HH:mm",disablePast:!0,name:"startTime",value:e.values.startTime,onChange:function(t){return e.setFieldValue("startTime",t)}})),s.a.createElement(Ee.a,{row:!0,className:t.formRow},s.a.createElement(Q.a,{className:t.marginRight,component:"label",variant:"h6",htmlFor:"type"},"Pelin tyyppi:"),s.a.createElement(me.a,{variant:"outlined"},s.a.createElement(re.a,{component:ge.a,name:"type",disabled:!0},s.a.createElement(de.a,{value:n.SANAKIERTO},"Sanakierto"))))),s.a.createElement("div",{className:t.gameInfo},s.a.createElement(Q.a,{className:t.marginRight,component:"label",variant:"h6",htmlFor:"players"},"Pelaajat:")),s.a.createElement(re.b,{name:"players",render:function(t){return function(e,t){return s.a.createElement(ce.a,null,s.a.createElement(oe.a,null,s.a.createElement(ie.a,null,s.a.createElement(le.a,null,"Nimi"),s.a.createElement(le.a,null,"Sana 1"),s.a.createElement(le.a,null,"Sana 2"),s.a.createElement(le.a,null,"Sana 3"))),s.a.createElement(ue.a,null,e.map((function(e,a){return s.a.createElement(ie.a,{key:a},s.a.createElement(le.a,null,s.a.createElement(re.a,{component:ge.b,name:"players.".concat(a,".name")})),e.words.map((function(a,n){return s.a.createElement(le.a,{key:"".concat(a).concat(n),style:{minWidth:190}},s.a.createElement("span",null,a," "),s.a.createElement(se.a,{size:"small",onClick:function(){return t(e,n)}},s.a.createElement(Oe.a,null)))})))}))))}(e.values.players,r)}}),s.a.createElement("div",{className:t.buttonRow},s.a.createElement(pe.a,{variant:"extended",color:"primary",className:t.marginRight,type:"submit"},"Luo peli"),s.a.createElement(pe.a,{variant:"extended",color:"secondary",onClick:a},"Peruuta")))},Ne=Object(V.a)((function(e){return Object(z.a)({formRow:{alignItems:"center",marginRight:e.spacing(2)},marginRight:{marginRight:e.spacing(2)},gameInfo:{display:"flex",marginTop:e.spacing(2),marginBottom:e.spacing(2)},buttonRow:{marginTop:e.spacing(2)},wordCell:{minWidth:190}})})),be=function(){var e=Ne(),t=Object(d.c)(),a=Object(F.f)(),o=function(){a.goBack()};return s.a.createElement("div",null,s.a.createElement(Q.a,{variant:"overline",gutterBottom:!0},"Luo uusi peli"),s.a.createElement(ee.a,null),s.a.createElement(te.a,{utils:ae.a,locale:ne.a},s.a.createElement(re.d,{initialValues:{startTime:new Date,type:n.SANAKIERTO,players:Ie(),status:r.UPCOMING,rounds:3},onSubmit:function(e,a){var n;console.log("values",e,"actions",a),console.log("adding new game"),t((n=e,function(){var e=Object(O.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:c.ADD_GAME_REQUEST}),e.prev=1,e.next=4,N.addNew(n);case 4:a=e.sent,t((r=a,{type:c.ADD_GAME_SUCCESS,payload:r})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t({type:c.ADD_GAME_FAILURE});case 11:case"end":return e.stop()}var r}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())),o()}},(function(t){return _e(t,e,o)}))))},je=a(14),he=a(106),Ce=a.n(he),ye=function(){return{event:o.JOIN_GAME,data:null}},Re=function(e){var t;Object(je.a)("recieved ".concat(i.CREATE_SUCCESS,", data:")),Object(je.a)(e),B.dispatch(L(e.jitsiRoom)),B.dispatch(C(e.game)),B.dispatch((t=e.jitsiToken,{type:c.SET_JITSI_TOKEN,payload:t}))},Ue=function(){Object(je.a)("recieved ".concat(o.GAME_READY));try{var e=B.getState().user.socket;if(!e)throw new Error("No socket set for user");Le.emit(e,ye())}catch(t){console.error(t.message)}},Le={getTokenForSocket:function(){var e=Object(O.a)(v.a.mark((function e(t,a){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.get("/api/games/".concat(t,"?pelaaja=").concat(a));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),authenticateSocket:function(e,t,a){return e.on(l.CONNECT,function(e,t,a){return function(){e.emit(l.AUTH_REQUEST,{token:t}).on(l.AUTHENTICATED,(function(){Object(je.a)("socketio authorized"),a(e)})).on(l.UNAUTHORIZED,(function(e){throw Object(je.a)("socketio unauthorized"),new Error(e.message)}))}}(e,t,a)),e},attachListeners:function(e,t){e.on(l.PLAYER_JOINED,(function(e){return function(e){Object(je.a)("recieved ".concat(l.PLAYER_JOINED));var t=B.getState().games.activeGame;if(!t)throw new Error("Player joined but no active game is set");var a=t.players.map((function(t){return t.id===e?Object(g.a)(Object(g.a)({},t),{},{online:!0}):t}));B.dispatch(C(Object(g.a)(Object(g.a)({},t),{},{players:a})))}(e)})),t?(e.on(i.CREATE_SUCCESS,(function(e){return Re(e)})),e.on(i.CREATE_FAILURE,(function(e){return function(e){return Object(je.a)("recieved ".concat(i.CREATE_FAILURE,": ").concat(e.error))}(e)})),e.on(i.START_SUCCESS,(function(e){var t;t=e,Object(je.a)("recieved ".concat(i.START_SUCCESS,":")),Object(je.a)(t),B.dispatch(C(t))})),e.on(i.START_FAILURE,(function(e){return function(e){return Object(je.a)("recieved ".concat(i.START_FAILURE,": ").concat(e.error))}(e)})),e.on(i.UPDATE_SUCCESS,(function(e){return function(e){Object(je.a)("recieved ".concat(i.UPDATE_SUCCESS,", data:")),Object(je.a)(e),B.dispatch(C(e))}(e)})),e.on(i.UPDATE_FAILURE,(function(e){return function(e){return Object(je.a)("recieved ".concat(i.UPDATE_FAILURE,": ").concat(e.error))}(e)}))):(e.on(o.JOIN_SUCCESS,(function(e){return function(e){Object(je.a)("recieved ".concat(o.JOIN_SUCCESS,":")),Object(je.a)(e),B.dispatch(L(e.jitsiRoom)),B.dispatch(C(e.game))}(e)})),e.on(o.JOIN_FAILURE,(function(e){return function(e){return Object(je.a)("recieved ".concat(o.JOIN_FAILURE,": ").concat(e.error))}(e)})),e.on(o.GAME_READY,Ue),e.on(o.GAME_STARTING,(function(e){return function(e){Object(je.a)("recieved ".concat(o.GAME_STARTING,":")),Object(je.a)(e),B.dispatch(C(e))}(e)})),e.on(o.GAME_UPDATED,(function(e){return function(e){Object(je.a)("recieved ".concat(o.GAME_UPDATED,":")),Object(je.a)(e),B.dispatch(C(e))}(e)})))},emit:function(e,t){var a=t.event,n=t.data;Object(je.a)("Emitting ".concat(a)),n&&(Object(je.a)("Data:"),Object(je.a)(n)),e.emit(a,n)}},Ge=function(e,t){try{var a=B.getState().user.socket;if(!a)throw new Error("Socket not set for user");Le.emit(a,function(e,t){return{event:i.JITSI_READY,data:{gameId:e,jitsiRoom:t}}}(e,t))}catch(n){console.error(n.message)}},we=function(e){try{var t=B.getState().user.socket;if(!t)throw new Error("Socket not set for user");Le.emit(t,function(e){return{event:i.START_GAME,data:e}}(e))}catch(a){console.error(a.message)}},ke=function(e){try{var t=B.getState().user.socket;if(!t)throw new Error("Socket not set for user");Le.emit(t,function(e){return{event:i.UPDATE_GAME,data:e}}(e))}catch(a){console.error(a.message)}},De=function(e){return e?function(t){Le.attachListeners(t,!0),Le.emit(t,function(e){return{event:i.CREATE_ROOM,data:e}}(e))}:function(e){Le.attachListeners(e,!1),Le.emit(e,ye())}},Me=function(){var e=Object(O.a)(v.a.mark((function e(t,a){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}throw new Error("Pelaajan id puuttuu");case 2:return e.next=4,Le.getTokenForSocket(t,a);case 4:return n=e.sent,Object(je.a)("Setting display name to '".concat(n.displayName,"'")),B.dispatch((r=n.displayName,{type:c.SET_DISPLAYNAME,payload:r})),e.abrupt("return",Le.authenticateSocket(Ce()(),n.token,De(null)));case 8:case"end":return e.stop()}var r}),e)})));return function(t,a){return e.apply(this,arguments)}}(),xe=a(42),Pe=a(152),Be=a(296),Fe=Object(V.a)((function(e){return Object(z.a)({container:{marginTop:e.spacing(2)},noPaddingX:{paddingLeft:0,paddingRight:0},saveBtnContainer:{textAlign:"center",marginTop:e.spacing(2)},additionBox:{minWidth:50}})})),He=function(e){var t=e.players,a=e.turn,n=e.handleUpdate,r=Fe(),c=s.a.useState(new Array(t.length).fill(!1)),o=Object(xe.a)(c,2),i=o[0],l=o[1],u=function(e){var n=t.length,r=i.reduce((function(e,t){return t?e+1:e}),0);switch(r){case n-1:case 0:return e===a?-50:0;case 1:return i[e]||e===a?100:0;case 2:return i[e]||e===a?30:0;case 3:return i[e]||e===a?10:0}return r};return s.a.createElement("div",{className:r.container},s.a.createElement(ce.a,null,s.a.createElement(ue.a,null,s.a.createElement(ie.a,null,s.a.createElement(le.a,{padding:"none",align:"center"},s.a.createElement(Q.a,{variant:"overline"},"Pelaaja")),s.a.createElement(le.a,{padding:"none",align:"center"},s.a.createElement(Q.a,{variant:"overline"},"Pisteet")),s.a.createElement(le.a,{padding:"none",align:"center"},s.a.createElement(Q.a,{variant:"overline"},"+ / -")),s.a.createElement(le.a,{padding:"none",align:"center"},s.a.createElement(Q.a,{variant:"overline",noWrap:!0},"Vastaus oikein"))),t.map((function(e,t){return s.a.createElement(ie.a,{key:t},s.a.createElement(le.a,{className:r.noPaddingX,align:"center"},s.a.createElement("span",null,e.name),e.online?null:s.a.createElement(Q.a,{variant:"caption",color:"error"}," (offline)")),s.a.createElement(le.a,{align:"center"},e.points),s.a.createElement(le.a,{align:"center",className:"".concat(r.noPaddingX," ").concat(r.additionBox)},function(e){var t=e>0?"+".concat(e):"".concat(e),a="";return e>0&&(a="green"),e<0&&(a="red"),s.a.createElement("span",{style:{color:a}},t)}(u(t))),s.a.createElement(le.a,{align:"center",padding:"checkbox"},t===a?s.a.createElement(Q.a,{variant:"caption",color:"textSecondary"},"Kysyj\xe4"):s.a.createElement(Be.a,{value:i[t],checked:i[t],onChange:function(){var e=Object(Pe.a)(i);e[t]=!e[t],l(e)}})))})))),s.a.createElement("div",{className:r.saveBtnContainer},s.a.createElement(pe.a,{variant:"extended",color:"primary",onClick:function(){var e=t.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{points:e.points+u(t)})}));l(new Array(t.length).fill(!1)),n(e)}},"P\xe4ivit\xe4 pisteet")))},Ke=function(e,t){var a=s.a.useRef();s.a.useEffect((function(){a.current=e}),[e]),s.a.useEffect((function(){if(null!==t){var e=setInterval((function(){if(!a||!a.current)throw new Error("Problem with interval hook");a.current()}),t);return function(){return clearInterval(e)}}}),[t])},Je=Object(V.a)((function(e){return Object(z.a)({container:{padding:e.spacing(1)},flex:{display:"flex",alignItems:"center"},grow:{flexGrow:1}})})),Ye=function(e){var t=e.game,a=Je(),n=Object(d.d)((function(e){return e.user.socket})),c=s.a.useState(!1),o=Object(xe.a)(c,2),i=o[0],l=o[1],u=s.a.useState(90),E=Object(xe.a)(u,2),m=E[0],p=E[1];if(Ke((function(){p(m-1),1===m&&l(!1)}),i?1e3:null),!n)return s.a.createElement(Q.a,null,"Yhdistet\xe4\xe4n...");var f=t.players,S=t.info,v=f.findIndex((function(e){return e.id===S.turn}));if(v<0)throw new Error("Something went wrong with player turns");var O=f[v];return s.a.createElement("div",{className:a.container},s.a.createElement(Q.a,{variant:"h6"},"Kierros ".concat(t.info.round)),s.a.createElement("div",{className:a.flex},s.a.createElement("div",{className:a.grow},s.a.createElement(Q.a,{variant:"overline",component:"div",className:a.grow},"Vuorossa:"),s.a.createElement(Q.a,{component:"div",gutterBottom:!0},O.name)),s.a.createElement("div",{className:a.grow},s.a.createElement(Q.a,{variant:"overline",component:"div",className:a.grow},"Sanat:"),s.a.createElement(Q.a,{component:"div",gutterBottom:!0},O.words.join(" / ")))),s.a.createElement("div",null,s.a.createElement(Q.a,{variant:"overline",component:"div"},"Vastausaika:"),s.a.createElement("div",{className:a.flex},s.a.createElement(Q.a,{component:"div",className:a.grow},0!==m?"".concat(m," sekuntia"):s.a.createElement(Q.a,{color:"textSecondary"},"Aika loppui")),s.a.createElement("div",{className:a.grow},s.a.createElement(pe.a,{variant:"extended",size:"small",color:"secondary",onClick:function(){0!==m&&l(!i)},disabled:0===m},i?"Pys\xe4yt\xe4":"K\xe4ynnist\xe4")))),s.a.createElement(He,{players:t.players,turn:t.players.indexOf(O),handleUpdate:function(e){var a,n;v===e.length-1?(a=t.info.round+1,n=e[0].id):(a=t.info.round,n=e[v+1].id);var c=Object(g.a)(Object(g.a)({},t),{},{players:e,info:{round:a,turn:n},status:a>t.rounds?r.FINISHED:r.RUNNING});ke(c),i&&l(!1),p(90)}}))},Qe=Object(V.a)((function(e){return Object(z.a)({container:{padding:e.spacing(2)},header:{marginLeft:e.spacing(2)}})})),We=function(e){var t=e.results,a=Qe();return s.a.createElement("div",{className:a.container},s.a.createElement(Q.a,{variant:"h4",gutterBottom:!0,className:a.header},"PELI P\xc4\xc4TTYI"),s.a.createElement(ce.a,null,s.a.createElement(ue.a,null,t.map((function(e,a){var n=s.a.createElement(ie.a,{key:e.name},s.a.createElement(le.a,null,e.name),s.a.createElement(le.a,null,"".concat(e.points," pistett\xe4")));return a<t.length-1&&t[a+1].points<e.points&&1,n})))))},Ve=function(e){var t=e.players;return s.a.createElement(ce.a,null,s.a.createElement(ue.a,null,s.a.createElement(ie.a,null,s.a.createElement(le.a,null,s.a.createElement(Q.a,{variant:"overline"},"Pelaaja")),s.a.createElement(le.a,{align:"center"},s.a.createElement(Q.a,{variant:"overline"},"Pisteet"))),t.map((function(e){return s.a.createElement(ie.a,{key:e.id},s.a.createElement(le.a,null,e.name),s.a.createElement(le.a,{align:"center"},e.points))}))))},ze=Object(V.a)((function(e){return Object(z.a)({container:{padding:e.spacing(2)}})})),Ze=function(e){var t=e.game,a=ze(),n=t.players,r=t.info,c=n.findIndex((function(e){return e.id===r.turn}));if(c<0)throw new Error("Something went wrong with player turns");var o=n[c];return s.a.createElement("div",null,s.a.createElement("div",{className:a.container},s.a.createElement(Q.a,{variant:"h6"},"Kierros ".concat(t.info.round)),s.a.createElement(Q.a,{variant:"overline",component:"div"},"Vuorossa:"),s.a.createElement(Q.a,{component:"div",gutterBottom:!0},o.name)),s.a.createElement(Ve,{players:t.players}))},Xe=a(148),qe=Object(V.a)((function(e){return Object(z.a)({loader:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},btnContainer:{textAlign:"center",marginBottom:e.spacing(2)}})})),$e=function(){var e=qe();return s.a.createElement("div",{className:e.loader},s.a.createElement(Q.a,null,"Ladataan videoyhteytt\xe4..."))},et=function(e){var t=e.token,a=e.roomName,n=e.displayName,r=e.loadedCallback,c=e.dev,o=s.a.useState(!c),i=Object(xe.a)(o,2),l=i[0],u=i[1],E=qe(),m=function(e){e.on("videoConferenceLeft",(function(){return function(e){u(!1),e.dispose()}(e)})),r()};if(!l)return s.a.createElement("div",{className:E.loader},s.a.createElement("div",{className:E.btnContainer},s.a.createElement(pe.a,{variant:"extended",onClick:function(){return u(!0)}},"K\xe4ynnist\xe4 video")),t&&s.a.createElement("div",{className:E.btnContainer},s.a.createElement(pe.a,{variant:"extended",onClick:r},"Trigger API loaded")));return s.a.createElement(Xe.a,{containerStyle:{width:"100%",height:"100%"},roomName:a,displayName:n||void 0,domain:"meet.kotipelit.com",jwt:t||void 0,loadingComponent:$e,onAPILoad:function(e){return m(e)},config:{subject:" "},interfaceConfig:{DEFAULT_REMOTE_DISPLAY_NAME:"Pelaaja",DISABLE_DOMINANT_SPEAKER_INDICATOR:!0,DISABLE_FOCUS_INDICATOR:!0,DISABLE_JOIN_LEAVE_NOTIFICATIONS:!0,DISABLE_PRESENCE_STATUS:!0,DISABLE_RINGING:!0,DISABLE_TRANSCRIPTION_SUBTITLES:!0,DISPLAY_WELCOME_PAGE_CONTENT:!1,DISPLAY_WELCOME_PAGE_TOOLBAR_ADDITIONAL_CONTENT:!0,ENABLE_DIAL_OUT:!1,filmStripOnly:!0,GENERATE_ROOMNAMES_ON_WELCOME_PAGE:!1,HIDE_INVITE_MORE_HEADER:!0,SHOW_JITSI_WATERMARK:!1,SHOW_WATERMARK_FOR_GUESTS:!1,RECENT_LIST_ENABLED:!1}})},tt=Object(V.a)((function(e){return Object(z.a)({startBtn:{textAlign:"center",margin:e.spacing(2)}})})),at=function(e){var t=e.game,a=e.handleStart,n=tt();return s.a.createElement("div",null,a&&s.a.createElement("div",{className:n.startBtn},s.a.createElement(pe.a,{variant:"extended",onClick:a},"Aloita peli")),s.a.createElement(ce.a,null,s.a.createElement(ue.a,null,t.players.map((function(e){return s.a.createElement(ie.a,{key:e.id},s.a.createElement(le.a,null,e.name),s.a.createElement(le.a,null,e.online?s.a.createElement(Q.a,{variant:"caption",color:"primary"},"Paikalla"):s.a.createElement(Q.a,{variant:"caption",color:"textSecondary"},"Odotetaan...")))})))))},nt=Object(V.a)((function(e){return Object(z.a)({container:{display:"flex"},jitsiContainer:{boxSizing:"border-box",width:"65%",backgroundColor:e.palette.grey[400]},hostControls:{boxSizing:"border-box",width:"35%",padding:e.spacing(2),marginLeft:e.spacing(1)}})})),rt=function(){var e=nt(),t=Object(d.d)((function(e){return e.games.activeGame})),a=Object(F.h)().gameID,n=Object(d.d)((function(e){return e.user}),d.b),c=Object(d.d)((function(e){return e.user.socket})),o=Object(d.d)((function(e){return e.user.jitsiRoom})),i=Object(F.g)(),l=Object(d.c)();s.a.useEffect((function(){c||(Object(je.a)("initializing socket"),n.loggedIn?l(G(function(e,t){if(!t)throw new Error("Pelin id puuttuu");return Le.authenticateSocket(Ce()(),e.token,De(t))}(n,a))):Me(a,function(e){return new URLSearchParams(e.search).get("pelaaja")}(i)).then((function(e){return l(G(e))})).catch((function(e){return console.error(e.message)})))}),[]);return s.a.createElement("div",{className:e.container},s.a.createElement($.a,{elevation:5,className:e.jitsiContainer},a&&o?s.a.createElement(et,{token:n.loggedIn?n.jitsiToken:null,roomName:o,displayName:n.loggedIn?n.username:n.displayName,loadedCallback:function(){return function(e,t){Ge(e,t)}(a,o)},dev:!0}):n.loggedIn?s.a.createElement(Q.a,null,"Ladataan..."):s.a.createElement(Q.a,null,"Odotetaan, ett\xe4 host k\xe4ynnist\xe4\xe4 pelin...")),s.a.createElement($.a,{elevation:5,className:e.hostControls},function(){return c&&t?t.status===r.WAITING?s.a.createElement(at,{game:t,handleStart:n.loggedIn?function(){we(a)}:null}):t.status===r.RUNNING?n.loggedIn?s.a.createElement(Ye,{game:t}):s.a.createElement(Ze,{game:t}):s.a.createElement(We,{results:(e=t.players,e.sort((function(e,t){return t.points-e.points})))}):s.a.createElement(Q.a,null,"Yhdistet\xe4\xe4n...");var e}()))},ct=a(107),ot=a(153),it=a(149),lt=a.n(it),ut=Object(V.a)((function(e){return Object(z.a)({container:{marginTop:e.spacing(1),padding:e.spacing(2)},infoBar:{alignItems:"center"},flex:{display:"flex",justifyContent:"space-between"},editButton:{marginLeft:e.spacing(1)},playerRow:{},inviteText:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}})})),st=function(e,t,a){return"Tervetuloa pelaamaan ".concat(Object(ct.capitalize)(e.type),"a!\n  \nSanasi ovat: ").concat(a?a.words.join(" "):"<Pelaajan sanat>","\n      \nTeht\xe4v\xe4n\xe4si on mietti\xe4 sanoille niit\xe4 kuvaavat vihjeet.\n      \nPeli alkaa ").concat(new Date(e.startTime).toUTCString(),"\n      \nN\xe4hd\xe4\xe4n peleill\xe4 osoitteessa:\n").concat(a?function(e,t,a){return"https://www.kotipelit.com".concat(t,"/").concat(e,"?pelaaja=").concat(a)}(e.id,t,null===a||void 0===a?void 0:a.id):"<Pelaajan linkki>")},Et=function(e){var t=e.game,a=ut(),n=Object(F.f)(),r=s.a.useState(null),o=Object(xe.a)(r,2),i=o[0],l=o[1],u=s.a.useState(st(t,n.location.pathname)),E=Object(xe.a)(u,2),m=E[0],p=E[1],f=Object(d.c)();return s.a.createElement($.a,{elevation:2,className:a.container},s.a.createElement("div",{className:"".concat(a.infoBar," ").concat(a.flex)},s.a.createElement("div",null,s.a.createElement(Q.a,null,new Date(t.startTime).toUTCString())),s.a.createElement("div",null,s.a.createElement(Q.a,null,Object(ct.capitalize)(t.type))),s.a.createElement("div",null,s.a.createElement(Q.a,null,"".concat(t.players.length," pelaajaa"))),s.a.createElement("div",null,s.a.createElement(Y.a,{variant:"contained",color:"secondary",onClick:function(){n.push("".concat(n.location.pathname,"/").concat(t.id))}},"K\xe4ynnist\xe4"),s.a.createElement(se.a,{size:"small",className:a.editButton,onClick:function(e){l(e.currentTarget)}},s.a.createElement(lt.a,null)),s.a.createElement(ot.a,{anchorEl:i,open:Boolean(i),onClose:function(){return l(null)},getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},s.a.createElement(de.a,null,s.a.createElement(Q.a,null,"Muokkaa")),s.a.createElement(de.a,{onClick:function(){var e;window.confirm("Poistetaanko peli?")&&f((e=t.id,function(){var t=Object(O.a)(v.a.mark((function t(a){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:c.DELETE_GAME_REQUEST}),t.prev=1,t.next=4,N.deleteGame(e);case 4:a((n=e,{type:c.DELETE_GAME_SUCCESS,payload:n})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),a({type:c.DELETE_GAME_FAILURE});case 10:case"end":return t.stop()}var n}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()))}},s.a.createElement(Q.a,{color:"secondary"},"Poista"))))),s.a.createElement("div",null,s.a.createElement(Q.a,{variant:"h6",gutterBottom:!0},"Pelaajat"),t.players.map((function(e){return s.a.createElement("div",{key:e.id,className:"".concat(a.flex," ").concat(a.playerRow)},s.a.createElement(Q.a,{component:"div"},e.name),s.a.createElement(Q.a,{component:"div"},e.words.join(" / ")),s.a.createElement("div",null,s.a.createElement(Y.a,{variant:"outlined",color:"primary",onClick:function(){return function(e,t,a){console.log("TODO: copy to clipboard?"),p(st(e,t,a))}(t,n.location.pathname,e)}},"N\xe4yt\xe4 kutsuteksti")))}))),s.a.createElement("div",{className:a.inviteText},s.a.createElement(Q.a,{variant:"h6",gutterBottom:!0},"Kutsuteksti"),s.a.createElement(Q.a,{style:{whiteSpace:"pre"}},m)))},mt=Object(V.a)((function(e){return Object(z.a)({marginTop:{marginTop:e.spacing(2)}})})),dt=function(e){var t=e.user,a=mt(),n=Object(d.d)((function(e){return e.games.allGames}));return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement(Q.a,{variant:"overline"},"Tulevat pelit:")),s.a.createElement("div",null,n&&n.map((function(e){return s.a.createElement(Et,{key:e.id,game:e})}))),s.a.createElement("div",{className:a.marginTop},s.a.createElement(pe.a,{color:"primary",variant:"extended",component:H.b,to:"/".concat(t.username,"/newgame")},"LUO PELI")))},pt=Object(V.a)((function(e){return Object(z.a)({marginBottom:{marginBottom:e.spacing(2)},container:{padding:e.spacing(3)}})})),ft=function(e){var t=e.labelText,a=pt(),n=Object(d.c)();s.a.useEffect((function(){n(function(){var e=Object(O.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:c.INIT_GAMES_REQUEST}),e.prev=1,e.next=4,N.getAll();case 4:a=e.sent,t(h(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t({type:c.INIT_GAMES_FAILURE});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())}),[n]);var r,o=Object(d.d)((function(e){return e.user})),i=(r=o)&&r.loggedIn?r:null;return s.a.createElement(H.a,null,s.a.createElement($.a,{elevation:5,className:a.container},s.a.createElement(Q.a,{variant:"h3",gutterBottom:!0},t),s.a.createElement(ee.a,{className:a.marginBottom}),s.a.createElement(F.c,null,s.a.createElement(F.a,{path:"/:username/newgame"},i?s.a.createElement(be,null):null),s.a.createElement(F.a,{path:"/:username/:gameID"},s.a.createElement(rt,null)),s.a.createElement(F.a,{path:"/"},i?s.a.createElement(dt,{user:i}):null))))},St=Object(V.a)((function(e){return Object(z.a)({navbar:{marginBottom:e.spacing(3)},toolbar:{display:"flex",justifyContent:"space-between"}})})),vt=function(){var e=St(),t=Object(d.c)(),a=Object(d.d)((function(e){return e.user}),d.b),n=Object(d.d)((function(e){return e.channels.allChannels}),d.b);s.a.useEffect((function(){t((function(e){var t=window.localStorage.getItem("kotipelitUser");if(t){var a=JSON.parse(t);_.setToken(a.token),e({type:c.LOGIN_SUCCESS,payload:a})}})),t(function(){var e=Object(O.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:c.INIT_CHANNELS_REQUEST}),e.prev=1,e.next=4,_.getAll();case 4:a=e.sent,t(D(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t({type:c.INIT_CHANNELS_FAILURE});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())}),[t]);return s.a.createElement(H.a,null,s.a.createElement(K.a,{position:"static",className:e.navbar},s.a.createElement(J.a,{className:e.toolbar},s.a.createElement(Y.a,{color:"inherit",component:H.b,to:"/"},s.a.createElement(Q.a,{variant:"h6"},"Kotipelit.com")),s.a.createElement(q,{user:a}))),s.a.createElement(W.a,null,s.a.createElement(F.c,null,function(e){return e.map((function(e){return s.a.createElement(F.a,{key:e.username,path:"/".concat(e.username)},s.a.createElement(ft,{labelText:e.channelName}))}))}(n),s.a.createElement(F.a,{path:"/"},s.a.createElement(X,null)))))};m.a.render(s.a.createElement(d.a,{store:B},s.a.createElement(vt,null)),document.getElementById("root"))}},[[172,1,2]]]);
//# sourceMappingURL=main.25a9c93b.chunk.js.map